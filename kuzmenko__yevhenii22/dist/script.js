let contentList=document.getElementsByClassName("my_list")[0],buttonClickPrevious=document.getElementById("buttonPrevious"),buttonClickNext=document.getElementById("buttonNext"),removeCards=document.getElementById("my_list__person"),globalIndex=1,emailAdd=document.getElementById("addYourEmail"),passwordAdd=document.getElementById("addYourPassword"),logInButton=document.getElementById("logInButton"),logInForm=document.getElementById("formForLogIn"),buttons=document.getElementsByClassName("my_list__button")[0],editForm=document.getElementById("editPerson").innerHTML,newUsersForm=document.getElementById("formForNewPerson"),newUsersList=document.getElementById("myNewCards"),contentListNewUsers=document.getElementsByClassName("my_newlist")[0],firstNameInput=document.getElementById("addFirstNamePerson"),lastNameInput=document.getElementById("addLastNamePerson"),emailInput=document.getElementById("addModifiedEmail"),jobInput=document.getElementById("addYourJob"),myButton=document.getElementById("addNewPersonButton"),logOutbuttonBlock=document.getElementsByClassName("log_out_block")[0],logOutButton=document.getElementById("logOutBtn");function displayNone(){contentList.style.display="none",buttons.style.display="none",newUsersForm.style.display="none",newUsersList.style.display="none"}function onSuccess(){logInForm.remove(),authorization(),logInForm.remove(),contentList.style.display="",buttons.style.display="",logOutbuttonBlock.style.display="",newUsersForm.style.display="",newUsersList.style.display="",creatCards(),createNewUsers(),click()}function logIn(){displayNone(),logInButton.addEventListener("click",e=>{e.preventDefault();let t=emailAdd.value,n=passwordAdd.value;t&&n&&api.loginApi({email:t,password:n}).then(e=>{200===e.status&&(onSuccess(),api.loginApi({email:t,password:n}).then(e=>e.json()).then(e=>{window.localStorage.setItem("token",e.token)}))}),emailAdd.value="",passwordAdd.value=""})}function creatCards(){api.cards(globalIndex).then(e=>e.json()).then(e=>{var t=e;for(let e=0;e<t.data.length;e++){let s=document.createElement("div"),i=(s.classList.add("my_list__person"),contentList.appendChild(s),document.createElement("img")),o=(i.classList.add("person__avatar"),s.appendChild(i),document.createElement("p")),r=(o.classList.add("person__email"),s.appendChild(o),document.createElement("p")),m=(r.classList.add("person__first_name"),s.appendChild(r),document.createElement("p"));m.classList.add("person__lastname"),s.appendChild(m);var n=document.createElement("p");n.classList.add("person__id"),s.appendChild(n);let c=document.createElement("button"),u=(c.classList.add("person__edit"),c.innerText="Edit user",s.appendChild(c),document.createElement("button"));u.classList.add("person__delete"),u.innerText="Delete user",s.appendChild(u);var a=JSON.stringify(t.data[e].avatar);i.src=a.replace(/"/g,"");a="Email: "+(a=JSON.stringify(t.data[e].email));o.innerText=a.replace(/"/g,"");a="First name: "+(a=JSON.stringify(t.data[e].first_name));r.innerText=a.replace(/"/g,"");a="Last name: "+(a=JSON.stringify(t.data[e].last_name)),a=(m.innerText=a.replace(/"/g,""),JSON.stringify(t.data[e].id));let p=a;n.innerText=a="ID: "+a,u.addEventListener("click",()=>{api.delete(p,s)}),c.addEventListener("click",()=>{let d=document.createElement("div");d.getAttribute("class","edit__block"),d.innerHTML=editForm,s.appendChild(d),c.remove(),u.remove();var e=document.getElementsByClassName("edit__cancel")[0],t=document.getElementsByClassName("edit__save")[0];e.addEventListener("click",()=>{d.remove(),s.appendChild(c),s.appendChild(u)}),t.addEventListener("click",e=>{e.preventDefault();let t=document.getElementById("emailEdit"),n=document.getElementById("firstNameEdit"),a=document.getElementById("lastNameEdit"),l=document.getElementById("avatarEdit");api.editUser(p,{email:t.value,name:n.value,lastName:a.value,avatar:l.value}).then(e=>{e.status=200,o.innerText="Email: "+t.value,r.innerText="First name: "+n.value,m.innerText="Last name: "+a.value,i.src=l.value,d.remove(),s.appendChild(c),s.appendChild(u)})})})}})}function remove(){var t=contentList.children.length;for(let e=0;e<t;e++)contentList.children[0].remove()}function click(){clickPrevious=()=>{remove(),globalIndex--,creatCards(),1===globalIndex&&(buttonClickPrevious.disabled=!0,buttonClickNext.disabled=!1)},clickNext=()=>{remove(),globalIndex++,creatCards(),2===globalIndex&&(buttonClickPrevious.disabled=!1,buttonClickNext.disabled=!0)},deleteToken=()=>{location.reload(),window.localStorage.removeItem("token")},buttonClickPrevious.addEventListener("click",clickPrevious),buttonClickNext.addEventListener("click",clickNext),logOutButton.addEventListener("click",deleteToken)}function createNewUsers(){myButton.addEventListener("click",e=>{e.preventDefault();e={name:firstNameInput.value,lastName:lastNameInput.value,email:emailInput.value,job:jobInput.value};firstNameInput.value&&lastNameInput.value&&emailInput.value&&jobInput.value&&(api.createNewCard(e).then(e=>e.json()).then(e=>{let s=e,i=(console.log(e),document.createElement("div")),o=(i.classList.add("my_list__person"),contentListNewUsers.appendChild(i),document.createElement("img")),r=(o.classList.add("person__avatar"),o.src="https://www.gateshead.church/dowo/wp-content/uploads/2019/09/person-icon.png",i.appendChild(o),document.createElement("p")),m=(r.classList.add("person__first_name"),r.innerText="First name: "+s.name,i.appendChild(r),document.createElement("p")),c=(m.classList.add("person__lastname"),m.innerText="Last name: "+s.lastName,i.appendChild(m),document.createElement("p"));c.classList.add("person__email"),c.innerText="Email: "+s.email,i.appendChild(c);e=document.createElement("p"),e.classList.add("person__email"),e.innerText="Job: "+s.job,i.appendChild(e),e=document.createElement("p");e.classList.add("person__email");let u=s.id,p=(e.innerText="ID: "+s.id,i.appendChild(e),document.createElement("button")),v=(p.classList.add("person__edit"),p.innerText="Edit user",i.appendChild(p),p.addEventListener("click",()=>{let d=document.createElement("div");d.getAttribute("class","edit__block"),d.innerHTML=editForm,i.appendChild(d),p.remove(),v.remove();var e=document.getElementsByClassName("edit__cancel")[0],t=document.getElementsByClassName("edit__save")[0];e.addEventListener("click",()=>{d.remove(),i.appendChild(p),i.appendChild(v)}),t.addEventListener("click",e=>{e.preventDefault();let t=document.getElementById("emailEdit"),n=document.getElementById("firstNameEdit"),a=document.getElementById("lastNameEdit"),l=document.getElementById("avatarEdit");t.value=t.value||s.email,n.value=n.value||s.name,a.value=a.value||s.lastName,l.value=l.value||o.src,api.editUser(u,{email:t.value,name:n.value,lastName:a.value,avatar:l.value}).then(e=>{e.status=200,c.innerText="Email: "+t.value,r.innerText="First name: "+n.value,m.innerText="Last name: "+a.value,o.src=l.value,d.remove(),i.appendChild(p),i.appendChild(v)})})}),document.createElement("button"));v.classList.add("person__delete"),v.innerText="Delete user",i.appendChild(v),v.addEventListener("click",()=>{api.delete(u,i)})}),firstNameInput.value="",lastNameInput.value="",emailInput.value="",jobInput.value="")})}function authorization(){localStorage.getItem("token")?(logInForm.remove(),contentList.style.display="",buttons.style.display="",logOutbuttonBlock.style.display="",newUsersForm.style.display="",newUsersList.style.display="",creatCards(),createNewUsers()):localStorage.getItem("token")||(logOutbuttonBlock.style.display="none")}logIn(),click(),authorization();